# Arkki Backup

Arkki is a backup solution for Linux.  Arkki is designed to stores archive
files:

  * Encrypted,
  * Off-site, and
  * Easily Recoverable

## Encrypted

Arkki uses public-key cryptography (GPG) to encrypt archives.  Encrypted
archives may be stored to removable disks or transmitted over internet.

## Off-site

Arkki stores archives to a removable hard-drive or a remote server.  Thus,
your files are protected against physical destruction of your hardware - be it
fire, flood or theft.

## Retrievable Everywhere

Arkki creates archives with standard Linux tools such as gpg, bzip2 and
tar.  As such, you can recover files on every Linux computer even without
having Arkki installed.


# Usage

```
Usage: arkki [options] command [arguments]
Commands:
    backup [dir/file]  Backup root to target directory or file
    init [file]        Create new configuration file
    setroot [dir]      Set root directory to back up
    exclude [patt]     Exclude files matching the pattern
    list               List files to be included in the backup
    print              Print current configuration
    help [command]     Show help on command
Options:
    --config file      Set configuration file to use
    --interactive      Enable interactive mode even though input is a file
    --batch            Run in batch mode
    --version          Show version and quit
    --verbose          Print additional status messages
    --quiet            Hide status messages and progress indicators
    --help             Show this message
```

## Full Backup

Back up files in your home directory to directory DIR as:

    arkki backup DIR

Directory argument may be omitted if you have set the output option in the
configuration file.

By default, Arkki backs up all files in your home directory.  See
configuration further below for infomation on how to leave out cache and
temporary files from the back to reduce the size of the archive.


## Recover Files

In order to recover files from an archive, first copy the archive to your
local machine.  This expedites recovery as you may need to process the
archive a couple of times.

Arkki uses common Unix tools such as tar, gpg and bzip2 to create
archives.  Typically, you would list files in an archive as

    gpg -d ARCHIVE | bunzip2 -c | tar tvf - | grep PATTERN

where ARCHIVE is the name of archive file generated by Arkki and
PATTERN is a partial file or directory name.  Be ware that Arkki has
an option to omit encryption and use gzip compression in which case
the command would have to be modified accordingly.

Once you have identified the files or directories to retrieve, then
copy the file names and extract them from the archive as

    gpg -d ARCHIVE | bunzip2 -c | tar xvf - FILES

where FILES is one or more file names from the list.


# Installation

Copy the arkki file from this repository and place to file to a directory
in your path.  For example, create directory bin in you home directory
and copy the file there.  Most Linux distros already add bin to your
path so arkki will be usable when you log back in.


# Configuration

In order to edit Arkki's configuration, first create a configuration file as:

    arkki init

By default, configuration files are stored to .config/arkki directory in your
home directory.  Open the default configuration file to your editor and update
the file accordingly.

The default configuration file may contain:

    [options]
    root=/home/ec-user
    output=
    encrypt=ec-user@mydomain.com
    compress=bzip2

    [exclude]
    pattern=/home/ec-user/.npm
    pattern=/home/ec-user/.cache
    pattern=*.tmp

## Options Section

### Root

Root directory to back up.

### Output

Default output directory for backups.  May be left empty and supplied as an
argument to backup command if the output directory will vary.

### Encrypt

User identifier for whom the backups will be encrypted.  Leave this to empty
to product un-encrypted archives.

### Compress

Name of compressor, bzip2 or gzip, or empty product un-compressed archives.

## Exclude Section

This section contains a set of exclusion patterns.  Add an exclusion pattern
for a file name or directory if you want to reduce the size of the archive.
Exclusion pattern is typically a directory name, e.g. ``/home/user1/tmp'', or
a wildcard pattern, e.g. ``*.obj''.

